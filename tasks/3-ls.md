# `ls`

Проект состоит из трёх программ: клиент, прокси, сервер. Вместе они имитируют работу bash-команды `ls`. Одну программу реализует один человек. Взаимодействие между программами ограничивается протоколом типа клиент-сервер, описанным ниже.

- Язык: C++ (не Си, т.е. создаём классы и не используем printf)
- Интерфейс: консольный
- ОС: Linux (Ubuntu 20 или 22)
- Сетевое взаимодействие: TCP-сокеты (`SOCK_STREAM`)
- Библиотеки: нельзя использовать библиотеки, абстрагирующие работу с сетью
- Система сборки: Makefile или CMake

Поскольку у каждого свой темп работы, для тестирования рекомендуется использовать программу `netcat`. Когда все три программы будут готовы, требуется протестировать проект целиком.

Доступные команды:

- `ls` — выводит содержимое директории, откуда запущена программа-сервер
- её параметры `-a`, `-h`, `-l` и их комбинации
- `ls /any/path` — выводит содержимое директории `/any/path` на сервере
	- или ошибку, если у пользователя, от имени которого запущена программа-сервер, нет доступа к этой директории

## 1. Клиент

Задачи программы-клиента:

- установить соединение с прокси или сервером
- предоставить поле для ввода команд и отправлять их на сервер нажатием `enter`
- отображать ответы сервера

Пример работы:

```bash
# здесь 7777      — порт, на котором запускается клиент
#       127.0.0.1 — ip-адрес, на котором слушает прокси
#       8888      — порт, на котором слушает прокси
./client 7777 127.0.0.1:8888
Connected to server at 127.0.0.1:8888

> ls
Desktop    Downloads  Qt      ...
Documents  Issues     Public  ...
> ls -hl
total 48K
drwxrwxr-x  2 user user 4,0K окт 13 14:30 Desktop
drwxr-xr-x  2 user user 4,0K ноя 20 15:59 Documents
drwxr-xr-x  2 user user 4,0K ноя 20 15:54 Downloads
drwxrwxr-x  8 user user 4,0K ноя 21 11:52 Issues
...
> ls /root
ls: cannot open directory '/root': Permission denied
```

Гарантируется, что сервер и прокси уже запущены к моменту запуска клиента.

## 2. Прокси

Прокси должен быть прозрачен для клиента, т.е. программа-клиент может считать, что подключилась напрямую к серверу. Задачи программы-прокси:

- установить соединение с сервером
- ожидать подключения от клиента
- перенаправлять команды от клиента на сервер
- перенаправлять ответы сервера на клиент
- если клиент отключается, продолжать работу и ожидать нового подключения
- печатать статус-сообщения: «сервер подключён», «клиент подключён»

Пример работы:

```bash
# здесь 127.0.0.1  — ip-адрес, на котором слушает прокси
#       8888       — порт, на котором слушает прокси
#       172.0.2.15 — ip-адрес, на котором слушает сервер
#       9999       — порт, на котором слушает сервер
./proxy 127.0.0.1:8888 172.0.2.15:9999

Connected to server at 172.0.2.15:9999
Listening at 127.0.0.1:8888
Got connection from 127.0.0.1:7777
Client disconnected
```

Гарантируется, что сервер уже запущен к моменту запуска прокси.

## 3. Сервер

Задачи программы-сервера:

- ожидать подключения от клиента
- если клиент отключается, продолжать работу и ожидать нового подключения
- выполнять перечисленные команды; на все другие сообщения отвечать ошибкой
	- предлагается просто выполнять `ls` в консольном подпроцессе и сохранять `stdout`
- печатать статус-сообщения: «клиент подключён», «команда выполнена»

Пример работы:

```bash
# здесь 172.0.2.15 — ip-адрес, на котором слушает сервер
#       9999       — порт, на котором слушает сервер
./server 172.0.2.15:9999

Listening at 172.0.2.15:9999
Got connection from 127.0.0.1:8888
Executed "ls"
Executed "ls -hl"
Executed "ls /root"
Client disconnected
```
